var rough=function(){"use strict";function a(){return{LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6}}var b=Math.pow,c=Math.cos,d=Math.sin,e=Math.PI,f=Math.sqrt,g=Math.max,h=Math.min,i=Math.abs,j=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},k=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=function(){function b(c,e,f,g){j(this,b),this.RoughSegmentRelationConst=a(),this.px1=c,this.py1=e,this.px2=f,this.py2=g,this.xi=d,this.yi=d,this.a=g-e,this.b=c-f,this.c=f*e-c*g,this._undefined=0==this.a&&0==this.b&&0==this.c}var d=Number.MAX_VALUE;return k(b,[{key:"isUndefined",value:function(){return this._undefined}},{key:"compare",value:function(e){if(this.isUndefined()||e.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var f=d,j=d,k=0,l=0,m=this.a,n=this.b,b=this.c;return(1e-5<i(n)&&(f=-m/n,k=-b/n),1e-5<i(e.b)&&(j=-e.a/e.b,l=-e.c/e.b),f==d)?j==d?-b/m==-e.c/e.a?this.py1>=h(e.py1,e.py2)&&this.py1<=g(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=h(e.py1,e.py2)&&this.py2<=g(e.py1,e.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=j*this.xi+l,-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(e.py1-this.yi)*(this.yi-e.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>i(e.a)?-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):j==d?(this.xi=e.px1,this.yi=f*this.xi+k,-1e-5>(e.py1-this.yi)*(this.yi-e.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>i(m)?-1e-5>(this.px1-this.xi)*(this.xi-this.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):f==j?k==l?this.px1>=h(e.px1,e.px2)&&this.px1<=g(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=h(e.px1,e.px2)&&this.px2<=g(e.px1,e.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=(l-k)/(f-j),this.yi=f*this.xi+k,-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}},{key:"getLength",value:function(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}},{key:"_getLength",value:function(a,b,c,d){var e=c-a,g=d-b;return f(e*e+g*g)}}]),b}(),m=function(){function b(a,c,d,e,f,g,h,k){j(this,b),this.top=a,this.bottom=c,this.left=d,this.right=e,this.gap=f,this.sinAngle=g,this.tanAngle=k,1e-4>i(g)?this.pos=d+f:.9999<i(g)?this.pos=a+f:(this.deltaX=(c-a)*i(k),this.pos=d-i(this.deltaX),this.hGap=i(f/h),this.sLeft=new l(d,c,d,a),this.sRight=new l(e,c,e,a))}return k(b,[{key:"getNextLine",value:function(){if(1e-4>i(this.sinAngle)){if(this.pos<this.right){var b=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,b}}else if(!(.9999<i(this.sinAngle))){var c=this.pos-this.deltaX/2,d=this.pos+this.deltaX/2,e=this.bottom,f=this.top;if(this.pos<this.right+this.deltaX){for(;c<this.left&&d<this.left||c>this.right&&d>this.right;)if(this.pos+=this.hGap,c=this.pos-this.deltaX/2,d=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var g=new l(c,e,d,f);g.compare(this.sLeft)==a().INTERSECTS&&(c=g.xi,e=g.yi),g.compare(this.sRight)==a().INTERSECTS&&(d=g.xi,f=g.yi),0<this.tanAngle&&(c=this.right-(c-this.left),d=this.right-(d-this.left));var h=[c,e,d,f];return this.pos+=this.hGap,h}}else if(this.pos<this.bottom){var j=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,j}return null}}]),b}(),n=function(){function a(b,c){j(this,a),this.type=b,this.text=c}return k(a,[{key:"isType",value:function(a){return this.type===a}}]),a}(),o=function(){function a(b){j(this,a),this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=b||"",this.parseData(b),this.processPoints()}return k(a,[{key:"loadFromSegments",value:function(a){this.segments=a,this.processPoints()}},{key:"processPoints",value:function(){for(var a,b=null,c=[0,0],d=0;d<this.segments.length;d++){switch(a=this.segments[d],a.key){case"M":case"L":case"T":a.point=[a.data[0],a.data[1]];break;case"m":case"l":case"t":a.point=[a.data[0]+c[0],a.data[1]+c[1]];break;case"H":a.point=[a.data[0],c[1]];break;case"h":a.point=[a.data[0]+c[0],c[1]];break;case"V":a.point=[c[0],a.data[0]];break;case"v":a.point=[c[0],a.data[0]+c[1]];break;case"z":case"Z":b&&(a.point=[b[0],b[1]]);break;case"C":a.point=[a.data[4],a.data[5]];break;case"c":a.point=[a.data[4]+c[0],a.data[5]+c[1]];break;case"S":a.point=[a.data[2],a.data[3]];break;case"s":a.point=[a.data[2]+c[0],a.data[3]+c[1]];break;case"Q":a.point=[a.data[2],a.data[3]];break;case"q":a.point=[a.data[2]+c[0],a.data[3]+c[1]];break;case"A":a.point=[a.data[5],a.data[6]];break;case"a":a.point=[a.data[5]+c[0],a.data[6]+c[1]];}("m"===a.key||"M"===a.key)&&(b=null),a.point&&(c=a.point,!b&&(b=a.point)),("z"===a.key||"Z"===a.key)&&(b=null)}}},{key:"parseData",value:function(a){var b=this.tokenize(a),c=0,d=b[c],e="BOD";for(this.segments=[];!d.isType(this.EOD);){var f,g=[];if("BOD"!=e)d.isType(this.NUMBER)?f=this.PARAMS[e].length:(c++,f=this.PARAMS[d.text].length,e=d.text);else if("M"==d.text||"m"==d.text)c++,f=this.PARAMS[d.text].length,e=d.text;else return this.parseData("M0,0"+a);if(c+f<b.length){for(var h,j=c;j<c+f;j++)if(h=b[j],h.isType(this.NUMBER))g[g.length]=h.text;else return void console.error("Parameter type is not a number: "+e+","+h.text);var i;if(this.PARAMS[e])i={key:e,data:g};else return void console.error("Unsupported segment type: "+e);this.segments.push(i),c+=f,d=b[c],"M"==e&&(e="L"),"m"==e&&(e="l")}else console.error("Path data ended before all parameters were found")}}},{key:"tokenize",value:function(a){for(var b=[];""!=a;)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))b[b.length]=new n(this.COMMAND,RegExp.$1),a=a.substr(RegExp.$1.length);else if(a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))b[b.length]=new n(this.NUMBER,parseFloat(RegExp.$1)),a=a.substr(RegExp.$1.length);else return console.error("Unrecognized segment command: "+a),null;return b[b.length]=new n(this.EOD,null),b}},{key:"closed",get:function(){if("undefined"==typeof this._closed){this._closed=!1;var a,b=!0,c=!1;try{for(var d,e,f=this.segments[Symbol.iterator]();!(b=(d=f.next()).done);b=!0)e=d.value,"z"===e.key.toLowerCase()&&(this._closed=!0)}catch(b){c=!0,a=b}finally{try{!b&&f.return&&f.return()}finally{if(c)throw a}}}return this._closed}}]),a}(),q=function(){function a(b){j(this,a),this.d=b,this.parsed=new o(b),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}return k(a,[{key:"setPosition",value:function(a,b){this._position=[a,b],this._first||(this._first=[a,b])}},{key:"segments",get:function(){return this.parsed.segments}},{key:"closed",get:function(){return this.parsed.closed}},{key:"linearPoints",get:function(){if(!this._linearPoints){var a,b=[],c=[],d=!0,e=!1;try{for(var f,g=this.parsed.segments[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var h=f.value,i=h.key.toLowerCase();("m"===i||"z"===i)&&(c.length&&(b.push(c),c=[]),"z"===i)||h.point&&c.push(h.point)}}catch(b){e=!0,a=b}finally{try{!d&&g.return&&g.return()}finally{if(e)throw a}}c.length&&(b.push(c),c=[]),this._linearPoints=b}return this._linearPoints}},{key:"first",get:function(){return this._first},set:function(a){this._first=a}},{key:"position",get:function(){return this._position}},{key:"x",get:function(){return this._position[0]}},{key:"y",get:function(){return this._position[1]}}]),a}(),p=function(){function a(b,g,h,k,l,m){j(this,a);var n=e/180;if(this._segIndex=0,this._numSegs=0,b[0]!=g[0]||b[1]!=g[1]){this._rx=i(h[0]),this._ry=i(h[1]),this._sinPhi=d(k*n),this._cosPhi=c(k*n);var o,p=this._cosPhi*(b[0]-g[0])/2+this._sinPhi*(b[1]-g[1])/2,q=-this._sinPhi*(b[0]-g[0])/2+this._cosPhi*(b[1]-g[1])/2,r=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*q*q-this._ry*this._ry*p*p;if(0>r){var t=f(1-r/(this._rx*this._rx*this._ry*this._ry));this._rx=t,this._ry=t,o=0}else o=(l==m?-1:1)*f(r/(this._rx*this._rx*q*q+this._ry*this._ry*p*p));var s=o*this._rx*q/this._ry,u=-o*this._ry*p/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*s-this._sinPhi*u+(b[0]+g[0])/2,this._C[1]=this._sinPhi*s+this._cosPhi*u+(b[1]+g[1])/2,this._theta=this.calculateVectorAngle(1,0,(p-s)/this._rx,(q-u)/this._ry);var v=this.calculateVectorAngle((p-s)/this._rx,(q-u)/this._ry,(-p-s)/this._rx,(-q-u)/this._ry);!m&&0<v?v-=2*e:m&&0>v&&(v+=2*e),this._numSegs=Math.ceil(i(v/(e/2))),this._delta=v/this._numSegs,this._T=8/3*d(this._delta/4)*d(this._delta/4)/d(this._delta/2),this._from=b}}return k(a,[{key:"getNextSegment",value:function(){var a,b,e;if(this._segIndex==this._numSegs)return null;var f=c(this._theta),g=d(this._theta),h=this._theta+this._delta,i=c(h),j=d(h);return e=[this._cosPhi*this._rx*i-this._sinPhi*this._ry*j+this._C[0],this._sinPhi*this._rx*i+this._cosPhi*this._ry*j+this._C[1]],a=[this._from[0]+this._T*(-this._cosPhi*this._rx*g-this._sinPhi*this._ry*f),this._from[1]+this._T*(-this._sinPhi*this._rx*g+this._cosPhi*this._ry*f)],b=[e[0]+this._T*(this._cosPhi*this._rx*j+this._sinPhi*this._ry*i),e[1]+this._T*(this._sinPhi*this._rx*j-this._cosPhi*this._ry*i)],this._theta=h,this._from=[e[0],e[1]],this._segIndex++,{cp1:a,cp2:b,to:e}}},{key:"calculateVectorAngle",value:function(a,b,c,d){var f=Math.atan2,g=f(b,a),h=f(d,c);return h>=g?h-g:2*e-(g-h)}}]),a}(),r=function(){function a(b,c){j(this,a),this.sets=b,this.closed=c}return k(a,[{key:"fit",value:function(a){var b,c=[],e=!0,f=!1;try{for(var g,h=this.sets[Symbol.iterator]();!(e=(g=h.next()).done);e=!0){var j=g.value,k=j.length,l=Math.floor(a*k);if(5>l){if(5>=k)continue;l=5}c.push(this.reduce(j,l))}}catch(a){f=!0,b=a}finally{try{!e&&h.return&&h.return()}finally{if(f)throw b}}var m,n="",d=!0,o=!1;try{for(var p,q,r=c[Symbol.iterator]();!(d=(p=r.next()).done);d=!0){q=p.value;for(var s,t=0;t<q.length;t++)s=q[t],n+=0===t?"M"+s[0]+","+s[1]:"L"+s[0]+","+s[1];this.closed&&(n+="z ")}}catch(a){o=!0,m=a}finally{try{!d&&r.return&&r.return()}finally{if(o)throw m}}return n}},{key:"distance",value:function(a,c){return f(b(a[0]-c[0],2)+b(a[1]-c[1],2))}},{key:"reduce",value:function(d,e){if(d.length<=e)return d;for(var g=d.slice(0);g.length>e;){for(var h=-1,j=-1,k=1;k<g.length-1;k++){var i=this.distance(g[k-1],g[k]),a=this.distance(g[k],g[k+1]),b=this.distance(g[k-1],g[k+1]),c=(i+a+b)/2,l=f(c*(c-i)*(c-a)*(c-b));(0>h||l<h)&&(h=l,j=k)}if(0<j)g.splice(j,1);else break}return g}}]),a}(),s=function(){function n(){j(this,n)}var s=Math.tan;return k(n,[{key:"line",value:function(a,b,c,d,e){var f=this._doubleLine(a,b,c,d,e);return{type:"path",ops:f}}},{key:"linearPath",value:function(a,b,c){var d=(a||[]).length;if(2<d){for(var e=[],f=0;f<d-1;f++)e=e.concat(this._doubleLine(a[f][0],a[f][1],a[f+1][0],a[f+1][1],c));return b&&(e=e.concat(this._doubleLine(a[d-1][0],a[d-1][1],a[0][0],a[0][1],c))),{type:"path",ops:e}}return 2===d?this.line(a[0][0],a[0][1],a[1][0],a[1][1],c):void 0}},{key:"polygon",value:function(a,b){return this.linearPath(a,!0,b)}},{key:"rectangle",value:function(a,b,c,d,e){return this.polygon([[a,b],[a+c,b],[a+c,b+d],[a,b+d]],e)}},{key:"curve",value:function(a,b){var c=this._curveWithOffset(a,1*(1+.2*b.roughness),b),d=this._curveWithOffset(a,1.5*(1+.22*b.roughness),b);return{type:"path",ops:c.concat(d)}}},{key:"ellipse",value:function(a,b,c,d,f){var g=2*e/f.curveStepCount,h=i(c/2),j=i(d/2);h+=this._getOffset(.05*-h,.05*h,f),j+=this._getOffset(.05*-j,.05*j,f);var k=this._ellipse(g,a,b,h,j,1,g*this._getOffset(.1,this._getOffset(.4,1,f),f),f),l=this._ellipse(g,a,b,h,j,1.5,0,f);return{type:"path",ops:k.concat(l)}}},{key:"arc",value:function(a,b,f,g,j,k,l,m,n){var o=a,p=b,q=i(f/2),r=i(g/2);q+=this._getOffset(.01*-q,.01*q,n),r+=this._getOffset(.01*-r,.01*r,n);for(var s=j,t=k;0>s;)s+=2*e,t+=2*e;t-s>2*e&&(s=0,t=2*e);var u=2*e/n.curveStepCount,v=h(u/2,(t-s)/2),w=this._arc(v,o,p,q,r,s,t,1,n),x=this._arc(v,o,p,q,r,s,t,1.5,n),y=w.concat(x);return l&&(m?(y=y.concat(this._doubleLine(o,p,o+q*c(s),p+r*d(s),n)),y=y.concat(this._doubleLine(o,p,o+q*c(t),p+r*d(t),n))):(y.push({op:"lineTo",data:[o,p]}),y.push({op:"lineTo",data:[o+q*c(s),p+r*d(s)]}))),{type:"path",ops:y}}},{key:"hachureFillArc",value:function(a,b,f,g,h,j,k){var l=a,m=b,n=i(f/2),o=i(g/2);n+=this._getOffset(.01*-n,.01*n,k),o+=this._getOffset(.01*-o,.01*o,k);for(var p=h,q=j;0>p;)p+=2*e,q+=2*e;q-p>2*e&&(p=0,q=2*e);for(var r=(q-p)/k.curveStepCount,s=[],t=[],u=p;u<=q;u+=r)s.push(l+n*c(u)),t.push(m+o*d(u));return s.push(l+n*c(q)),t.push(m+o*d(q)),s.push(l),t.push(m),this.hachureFillShape(s,t,k)}},{key:"solidFillShape",value:function(a,b,c){var d=[];if(a&&b&&a.length&&b.length&&a.length===b.length){var e=c.maxRandomnessOffset||0,f=a.length;if(2<f){d.push({op:"move",data:[a[0]+this._getOffset(-e,e,c),b[0]+this._getOffset(-e,e,c)]});for(var g=1;g<f;g++)d.push({op:"lineTo",data:[a[g]+this._getOffset(-e,e,c),b[g]+this._getOffset(-e,e,c)]})}}return{type:"fillPath",ops:d}}},{key:"hachureFillShape",value:function(a,b,f){var j=[];if(a&&b&&a.length&&b.length){for(var k=a[0],l=a[0],n=b[0],o=b[0],p=1;p<a.length;p++)k=h(k,a[p]),l=g(l,a[p]),n=h(n,b[p]),o=g(o,b[p]);var i=f.hachureAngle,q=f.hachureGap;0>q&&(q=4*f.strokeWidth),q=g(q,.1);for(var r,t=i%180*(e/180),u=c(t),v=d(t),w=s(t),x=new m(n-1,o+1,k-1,l+1,q,v,u,w);null!=(r=x.getNextLine());)for(var y=this._getIntersectingLines(r,a,b),z=0;z<y.length;z++)if(z<y.length-1){var A=y[z],B=y[z+1];j=j.concat(this._doubleLine(A[0],A[1],B[0],B[1],f))}}return{type:"path",ops:j}}},{key:"hachureFillEllipse",value:function(a,b,c,d,g){var h=[],j=i(c/2),k=i(d/2);j+=this._getOffset(.05*-j,.05*j,g),k+=this._getOffset(.05*-k,.05*k,g);var l=g.hachureAngle,m=g.hachureGap;0>=m&&(m=4*g.strokeWidth);var n=g.fillWeight;0>n&&(n=g.strokeWidth/2);for(var o=s(l%180*(e/180)),p=k/j,q=f(p*o*p*o+1),r=p*o/q,t=1/q,u=m/(j*k/f(k*t*(k*t)+j*r*(j*r))/j),v=f(j*j-(a-j+u)*(a-j+u)),w=a-j+u;w<a+j;w+=u){v=f(j*j-(a-w)*(a-w));var x=this._affine(w,b-v,a,b,r,t,p),y=this._affine(w,b+v,a,b,r,t,p);h=h.concat(this._doubleLine(x[0],x[1],y[0],y[1],g))}return{type:"path",ops:h}}},{key:"svgPath",value:function(a,b){a=(a||"").replace(/\n/g," ").replace(/(-)/g," -").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var c=new q(a);if(b.simplification){var e=new r(c.linearPoints,c.closed),f=e.fit(b.simplification);c=new q(f)}for(var d=[],g=c.segments||[],h=0;h<g.length;h++){var i=g[h],j=0<h?g[h-1]:null,k=this._processSegment(c,i,j,b);k&&k.length&&(d=d.concat(k))}return{type:"path",ops:d}}},{key:"_bezierTo",value:function(a,b,c,d,e,g,h,j){for(var k=[],l=[j.maxRandomnessOffset||1,(j.maxRandomnessOffset||1)+.5],m=null,f=0;2>f;f++)0===f?k.push({op:"move",data:[h.x,h.y]}):k.push({op:"move",data:[h.x+this._getOffset(-l[0],l[0],j),h.y+this._getOffset(-l[0],l[0],j)]}),m=[e+this._getOffset(-l[f],l[f],j),g+this._getOffset(-l[f],l[f],j)],k.push({op:"bcurveTo",data:[a+this._getOffset(-l[f],l[f],j),b+this._getOffset(-l[f],l[f],j),c+this._getOffset(-l[f],l[f],j),d+this._getOffset(-l[f],l[f],j),m[0],m[1]]});return h.setPosition(m[0],m[1]),k}},{key:"_processSegment",value:function(a,b,c,d){var e=[];switch(b.key){case"M":case"m":{var g="m"===b.key;if(2<=b.data.length){var h=+b.data[0],j=+b.data[1];g&&(h+=a.x,j+=a.y);var k=1*(d.maxRandomnessOffset||0);h+=this._getOffset(-k,k,d),j+=this._getOffset(-k,k,d),a.setPosition(h,j),e.push({op:"move",data:[h,j]})}break}case"L":case"l":{var l="l"===b.key;if(2<=b.data.length){var m=+b.data[0],n=+b.data[1];l&&(m+=a.x,n+=a.y),e=e.concat(this._doubleLine(a.x,a.y,m,n,d)),a.setPosition(m,n)}break}case"H":case"h":{var o="h"===b.key;if(b.data.length){var q=+b.data[0];o&&(q+=a.x),e=e.concat(this._doubleLine(a.x,a.y,q,a.y,d)),a.setPosition(q,a.y)}break}case"V":case"v":{var r="v"===b.key;if(b.data.length){var s=+b.data[0];r&&(s+=a.y),e=e.concat(this._doubleLine(a.x,a.y,a.x,s,d)),a.setPosition(a.x,s)}break}case"Z":case"z":{a.first&&(e=e.concat(this._doubleLine(a.x,a.y,a.first[0],a.first[1],d)),a.setPosition(a.first[0],a.first[1]),a.first=null);break}case"C":case"c":{var t="c"===b.key;if(6<=b.data.length){var u=+b.data[0],v=+b.data[1],w=+b.data[2],x=+b.data[3],y=+b.data[4],z=+b.data[5];t&&(u+=a.x,w+=a.x,y+=a.x,v+=a.y,x+=a.y,z+=a.y);var A=this._bezierTo(u,v,w,x,y,z,a,d);e=e.concat(A),a.bezierReflectionPoint=[y+(y-w),z+(z-x)]}break}case"S":case"s":{var B="s"===b.key;if(4<=b.data.length){var C=+b.data[0],D=+b.data[1],E=+b.data[2],F=+b.data[3];B&&(C+=a.x,E+=a.x,D+=a.y,F+=a.y);var G=C,H=D,I=c?c.key:"",J=null;("c"==I||"C"==I||"s"==I||"S"==I)&&(J=a.bezierReflectionPoint),J&&(G=J[0],H=J[1]);var K=this._bezierTo(G,H,C,D,E,F,a,d);e=e.concat(K),a.bezierReflectionPoint=[E+(E-C),F+(F-D)]}break}case"Q":case"q":{var L="q"===b.key;if(4<=b.data.length){var M=+b.data[0],N=+b.data[1],O=+b.data[2],P=+b.data[3];L&&(M+=a.x,O+=a.x,N+=a.y,P+=a.y);var Q=1*(1+.2*d.roughness),R=1.5*(1+.22*d.roughness);e.push({op:"move",data:[a.x+this._getOffset(-Q,Q,d),a.y+this._getOffset(-Q,Q,d)]});var S=[O+this._getOffset(-Q,Q,d),P+this._getOffset(-Q,Q,d)];e.push({op:"qcurveTo",data:[M+this._getOffset(-Q,Q,d),N+this._getOffset(-Q,Q,d),S[0],S[1]]}),e.push({op:"move",data:[a.x+this._getOffset(-R,R,d),a.y+this._getOffset(-R,R,d)]}),S=[O+this._getOffset(-R,R,d),P+this._getOffset(-R,R,d)],e.push({op:"qcurveTo",data:[M+this._getOffset(-R,R,d),N+this._getOffset(-R,R,d),S[0],S[1]]}),a.setPosition(S[0],S[1]),a.quadReflectionPoint=[O+(O-M),P+(P-N)]}break}case"T":case"t":{var f="t"===b.key;if(2<=b.data.length){var T=+b.data[0],U=+b.data[1];f&&(T+=a.x,U+=a.y);var V=T,W=U,X=c?c.key:"",J=null;("q"==X||"Q"==X||"t"==X||"T"==X)&&(J=a.quadReflectionPoint),J&&(V=J[0],W=J[1]);var Y=1*(1+.2*d.roughness),Z=1.5*(1+.22*d.roughness);e.push({op:"move",data:[a.x+this._getOffset(-Y,Y,d),a.y+this._getOffset(-Y,Y,d)]});var $=[T+this._getOffset(-Y,Y,d),U+this._getOffset(-Y,Y,d)];e.push({op:"qcurveTo",data:[V+this._getOffset(-Y,Y,d),W+this._getOffset(-Y,Y,d),$[0],$[1]]}),e.push({op:"move",data:[a.x+this._getOffset(-Z,Z,d),a.y+this._getOffset(-Z,Z,d)]}),$=[T+this._getOffset(-Z,Z,d),U+this._getOffset(-Z,Z,d)],e.push({op:"qcurveTo",data:[V+this._getOffset(-Z,Z,d),W+this._getOffset(-Z,Z,d),$[0],$[1]]}),a.setPosition($[0],$[1]),a.quadReflectionPoint=[T+(T-V),U+(U-W)]}break}case"A":case"a":{var _="a"===b.key;if(7<=b.data.length){var aa=+b.data[0],ba=+b.data[1],ca=+b.data[2],da=+b.data[3],ea=+b.data[4],fa=+b.data[5],ga=+b.data[6];if(_&&(fa+=a.x,ga+=a.y),fa==a.x&&ga==a.y)break;if(0==aa||0==ba)e=e.concat(this._doubleLine(a.x,a.y,fa,ga,d)),a.setPosition(fa,ga);else for(var ha=d.maxRandomnessOffset||0,ia=0;1>ia;ia++)for(var i,ja=new p([a.x,a.y],[fa,ga],[aa,ba],ca,!!da,!!ea),ka=ja.getNextSegment();ka;)i=this._bezierTo(ka.cp1[0],ka.cp1[1],ka.cp2[0],ka.cp2[1],ka.to[0],ka.to[1],a,d),e=e.concat(i),ka=ja.getNextSegment()}break}default:}return e}},{key:"_getOffset",value:function(a,b,c){return c.roughness*(Math.random()*(b-a)+a)}},{key:"_affine",value:function(a,b,c,d,e,f,g){return[-c*f-d*e+c+f*a+e*b,g*(c*e-d*f)+d+-g*e*a+g*f*b]}},{key:"_doubleLine",value:function(a,b,c,d,e){var f=this._line(a,b,c,d,e,!0,!1),g=this._line(a,b,c,d,e,!0,!0);return f.concat(g)}},{key:"_line",value:function(a,c,d,e,g,h,i){var j=b(a-d,2)+b(c-e,2),k=g.maxRandomnessOffset||0;100*(k*k)>j&&(k=f(j)/10);var l=k/2,m=.2+.2*Math.random(),n=g.bowing*g.maxRandomnessOffset*(e-c)/200,o=g.bowing*g.maxRandomnessOffset*d/200;n=this._getOffset(-n,n,g),o=this._getOffset(-o,o,g);var p=[];return h&&(i?p.push({op:"move",data:[a+this._getOffset(-l,l,g),c+this._getOffset(-l,l,g)]}):p.push({op:"move",data:[a+this._getOffset(-k,k,g),c+this._getOffset(-k,k,g)]})),i?p.push({op:"bcurveTo",data:[n+a+(d-a)*m+this._getOffset(-l,l,g),o+c+(e-c)*m+this._getOffset(-l,l,g),n+a+2*(d-a)*m+this._getOffset(-l,l,g),o+c+2*(e-c)*m+this._getOffset(-l,l,g),d+this._getOffset(-l,l,g),e+this._getOffset(-l,l,g)]}):p.push({op:"bcurveTo",data:[n+a+(d-a)*m+this._getOffset(-k,k,g),o+c+(e-c)*m+this._getOffset(-k,k,g),n+a+2*(d-a)*m+this._getOffset(-k,k,g),o+c+2*(e-c)*m+this._getOffset(-k,k,g),d+this._getOffset(-k,k,g),e+this._getOffset(-k,k,g)]}),p}},{key:"_curve",value:function(a,c,d){var e=a.length,f=[];if(3<e){var g=[],b=1-d.curveTightness;f.push({op:"move",data:[a[1][0],a[1][1]]});for(var h,j=1;j+2<e;j++)h=a[j],g[0]=[h[0],h[1]],g[1]=[h[0]+(b*a[j+1][0]-b*a[j-1][0])/6,h[1]+(b*a[j+1][1]-b*a[j-1][1])/6],g[2]=[a[j+1][0]+(b*a[j][0]-b*a[j+2][0])/6,a[j+1][1]+(b*a[j][1]-b*a[j+2][1])/6],g[3]=[a[j+1][0],a[j+1][1]],f.push({op:"bcurveTo",data:[g[1][0],g[1][1],g[2][0],g[2][1],g[3][0],g[3][1]]});if(c&&2===c.length){var i=d.maxRandomnessOffset;f.push({ops:"lineTo",data:[c[0]+this._getOffset(-i,i,d),c[1]+ +this._getOffset(-i,i,d)]})}}else 3===e?(f.push({op:"move",data:[a[1][0],a[1][1]]}),f.push({op:"bcurveTo",data:[a[1][0],a[1][1],a[2][0],a[2][1],a[2][0],a[2][1]]})):2===e&&(f=f.concat(this._doubleLine(a[0][0],a[0][1],a[1][0],a[1][1],d)));return f}},{key:"_ellipse",value:function(a,b,f,g,h,i,j,k){var l=this._getOffset(-.5,.5,k)-e/2,m=[];m.push([this._getOffset(-i,i,k)+b+.9*g*c(l-a),this._getOffset(-i,i,k)+f+.9*h*d(l-a)]);for(var n=l;n<2*e+l-.01;n+=a)m.push([this._getOffset(-i,i,k)+b+g*c(n),this._getOffset(-i,i,k)+f+h*d(n)]);return m.push([this._getOffset(-i,i,k)+b+g*c(l+2*e+.5*j),this._getOffset(-i,i,k)+f+h*d(l+2*e+.5*j)]),m.push([this._getOffset(-i,i,k)+b+.98*g*c(l+j),this._getOffset(-i,i,k)+f+.98*h*d(l+j)]),m.push([this._getOffset(-i,i,k)+b+.9*g*c(l+.5*j),this._getOffset(-i,i,k)+f+.9*h*d(l+.5*j)]),this._curve(m,null,k)}},{key:"_curveWithOffset",value:function(a,b,c){for(var d=[[a[0][0]+this._getOffset(-b,b,c),a[0][1]+this._getOffset(-b,b,c)],[a[0][0]+this._getOffset(-b,b,c),a[0][1]+this._getOffset(-b,b,c)]],e=1;e<a.length;e++)d.push([a[e][0]+this._getOffset(-b,b,c),a[e][1]+this._getOffset(-b,b,c)]),e===a.length-1&&d.push([a[e][0]+this._getOffset(-b,b,c),a[e][1]+this._getOffset(-b,b,c)]);return this._curve(d,null,c)}},{key:"_arc",value:function(a,b,e,f,g,h,i,j,k){var l=h+this._getOffset(-.1,.1,k),m=[];m.push([this._getOffset(-j,j,k)+b+.9*f*c(l-a),this._getOffset(-j,j,k)+e+.9*g*d(l-a)]);for(var n=l;n<=i;n+=a)m.push([this._getOffset(-j,j,k)+b+f*c(n),this._getOffset(-j,j,k)+e+g*d(n)]);return m.push([b+f*c(i),e+g*d(i)]),m.push([b+f*c(i),e+g*d(i)]),this._curve(m,null,k)}},{key:"_getIntersectingLines",value:function(b,c,d){for(var e,f=[],g=new l(b[0],b[1],b[2],b[3]),h=0;h<c.length;h++)e=new l(c[h],d[h],c[(h+1)%c.length],d[(h+1)%c.length]),g.compare(e)==a().INTERSECTS&&f.push([g.xi,g.yi]);return f}}]),n}();self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;var t=function(){function a(b,c){j(this,a),this.config=c||{},this.canvas=b,this.ctx=this.canvas.getContext("2d"),this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}return k(a,[{key:"lib",value:async function(){if(!this._renderer)if(window.workly&&!this.config.noWorker){var a=Function.prototype.toString,b=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",c=this.config.roughURL||self._roughScript;if(c&&b){var d=URL.createObjectURL(new Blob(["importScripts('"+b+"', '"+c+"');\nworkly.expose(self.rough.createRenderer());"]));this._renderer=workly.proxy(d)}else this._renderer=new s}else this._renderer=new s;return this._renderer}},{key:"line",value:async function(a,b,c,d,e){var f=this._options(e),g=await this.lib(),h=await g.line(a,b,c,d,f);this._draw(this.ctx,h,f)}},{key:"rectangle",value:async function(a,b,c,d,e){var f=this._options(e),g=await this.lib();if(f.fill){var h=this.ctx,i=[a,a+c,a+c,a],j=[b,b,b+d,b+d];if("solid"===f.fillStyle){var k=await g.solidFillShape(i,j,f);this._fill(h,k,f)}else{var l=await g.hachureFillShape(i,j,f);this._fillSketch(h,l,f)}}var m=await g.rectangle(a,b,c,d,f);this._draw(this.ctx,m,f)}},{key:"ellipse",value:async function(a,b,c,d,e){var f=this._options(e),g=await this.lib();if(f.fill)if("solid"===f.fillStyle){var h=await g.ellipse(a,b,c,d,f);this._fill(this.ctx,h,f)}else{var i=await g.hachureFillEllipse(a,b,c,d,f);this._fillSketch(this.ctx,i,f)}var j=await g.ellipse(a,b,c,d,f);this._draw(this.ctx,j,f)}},{key:"circle",value:async function(a,b,c,d){return await this.ellipse(a,b,c,c,d)}},{key:"linearPath",value:async function(a,b){var c=this._options(b),d=await this.lib(),e=await d.linearPath(a,!1,c);this._draw(this.ctx,e,c)}},{key:"polygon",value:async function(a,b){var c=this._options(b),d=await this.lib();if(c.fill){var e,f=[],g=[],h=!0,i=!1;try{for(var j,k,l=a[Symbol.iterator]();!(h=(j=l.next()).done);h=!0)k=j.value,f.push(k[0]),g.push(k[1])}catch(a){i=!0,e=a}finally{try{!h&&l.return&&l.return()}finally{if(i)throw e}}if("solid"===c.fillStyle){var m=await d.solidFillShape(f,g,c);this._fill(this.ctx,m,c)}else{var n=await d.hachureFillShape(f,g,c);this._fillSketch(this.ctx,n,c)}}var o=await d.linearPath(a,!0,c);this._draw(this.ctx,o,c)}},{key:"arc",value:async function(a,b,c,d,e,f,g,h){var i=this._options(h),j=await this.lib();if(g&&i.fill)if("solid"===i.fillStyle){var k=await j.arc(a,b,c,d,e,f,!0,!1,i);this._fill(this.ctx,k,i)}else{var l=await j.hachureFillArc(a,b,c,d,e,f,i);this._fillSketch(this.ctx,l,i)}var m=await j.arc(a,b,c,d,e,f,g,!0,i);this._draw(this.ctx,m,i)}},{key:"curve",value:async function(a,b){var c=this._options(b),d=await this.lib(),e=await d.curve(a,c);this._draw(this.ctx,e,c)}},{key:"path",value:async function(a,b){if(a){var c=this._options(b),d=await this.lib();if(c.fill)if("solid"===c.fillStyle){this.ctx.save(),this.ctx.fillStyle=c.fill;var e=new Path2D(a);this.ctx.fill(e),this.ctx.restore()}else{var f=[0,0];try{var g="http://www.w3.org/2000/svg",i=document.createElementNS(g,"svg");i.setAttribute("width","0"),i.setAttribute("height","0");var j=document.createElementNS(g,"path");j.setAttribute("d",a),i.appendChild(j),document.body.appendChild(i);var k=j.getBBox();k&&(f[0]=k.width||0,f[1]=k.height||0),document.body.removeChild(i)}catch(a){}f[0]*f[1]||(f=[this.canvas.width||100,this.canvas.height||100]),f[0]=h(4*f[0],this.canvas.width),f[1]=h(4*f[1],this.canvas.height);var l=[0,f[0],f[0],0],m=[0,0,f[1],f[1]],n=await d.hachureFillShape(l,m,c),o=document.createElement("canvas");o.width=f[0],o.height=f[1],this._fillSketch(o.getContext("2d"),n,c),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(o,"repeat");var p=new Path2D(a);this.ctx.fill(p),this.ctx.restore()}var q=await d.svgPath(a,c);this._draw(this.ctx,q,c)}}},{key:"_options",value:function(a){return a?Object.assign({},this.defaultOptions,a):this.defaultOptions}},{key:"_draw",value:function(a,b,c){a.save(),a.strokeStyle=c.stroke,a.lineWidth=c.strokeWidth,this._drawToContext(a,b),a.restore()}},{key:"_fillSketch",value:function(a,b,c){var d=c.fillWeight;0>d&&(d=c.strokeWidth/2),a.save(),a.strokeStyle=c.fill,a.lineWidth=d,this._drawToContext(a,b),a.restore()}},{key:"_fill",value:function(a,b,c){a.save(),a.fillStyle=c.fill,b.type="fillPath",this._drawToContext(a,b,c),a.restore()}},{key:"_drawToContext",value:function(a,b){if("path"===b.type||"fillPath"===b.type){a.beginPath();var c,d=!0,e=!1;try{for(var f,g=b.ops[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var h=f.value,i=h.data;switch(h.op){case"move":a.moveTo(i[0],i[1]);break;case"bcurveTo":a.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"qcurveTo":a.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"lineTo":a.lineTo(i[0],i[1]);}}}catch(a){e=!0,c=a}finally{try{!d&&g.return&&g.return()}finally{if(e)throw c}}"fillPath"===b.type?a.fill():a.stroke()}}}],[{key:"createRenderer",value:function(){return new s}}]),a}();return{canvas:function(a,b){return new t(a,b)},createRenderer:function(){return t.createRenderer()}}}();