var rough=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(){return{LEFT:0,RIGHT:1,INTERSECTS:2,AHEAD:3,BEHIND:4,SEPARATE:5,UNDEFINED:6}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(s,i){try{var o=t[s](i),l=o.value}catch(e){return void n(e)}return o.done?void e(l):Promise.resolve(l).then(function(e){a("next",e)},function(e){a("throw",e)})}return a("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=Math.pow,r=Math.cos,p=Math.sin,f=Math.PI,g=Math.sqrt,d=Math.max,u=Math.min,h=Math.abs,_=function(){function e(e,t){for(var n,a=0;a<t.length;a++)n=t[a],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),y=function(){function n(a,i,o,l){e(this,n),this.RoughSegmentRelationConst=t(),this.px1=a,this.py1=i,this.px2=o,this.py2=l,this.xi=s,this.yi=s,this.a=l-i,this.b=a-o,this.c=o*i-a*l,this._undefined=0==this.a&&0==this.b&&0==this.c}var s=Number.MAX_VALUE;return _(n,[{key:"isUndefined",value:function(){return this._undefined}},{key:"compare",value:function(e){if(this.isUndefined()||e.isUndefined())return this.RoughSegmentRelationConst.UNDEFINED;var t=s,n=s,i=0,o=0,l=this.a,r=this.b,p=this.c;return(1e-5<h(r)&&(t=-l/r,i=-p/r),1e-5<h(e.b)&&(n=-e.a/e.b,o=-e.c/e.b),t==s)?n==s?-p/l==-e.c/e.a?this.py1>=u(e.py1,e.py2)&&this.py1<=d(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.py2>=u(e.py1,e.py2)&&this.py2<=d(e.py1,e.py2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=this.px1,this.yi=n*this.xi+o,-1e-5>(this.py1-this.yi)*(this.yi-this.py2)||-1e-5>(e.py1-this.yi)*(this.yi-e.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>h(e.a)?-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):n==s?(this.xi=e.px1,this.yi=t*this.xi+i,-1e-5>(e.py1-this.yi)*(this.yi-e.py2)||-1e-5>(this.py1-this.yi)*(this.yi-this.py2)?this.RoughSegmentRelationConst.SEPARATE:1e-5>h(l)?-1e-5>(this.px1-this.xi)*(this.xi-this.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS:this.RoughSegmentRelationConst.INTERSECTS):t==n?i==o?this.px1>=u(e.px1,e.px2)&&this.px1<=d(e.py1,e.py2)?(this.xi=this.px1,this.yi=this.py1,this.RoughSegmentRelationConst.INTERSECTS):this.px2>=u(e.px1,e.px2)&&this.px2<=d(e.px1,e.px2)?(this.xi=this.px2,this.yi=this.py2,this.RoughSegmentRelationConst.INTERSECTS):this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.SEPARATE:(this.xi=(o-i)/(t-n),this.yi=t*this.xi+i,-1e-5>(this.px1-this.xi)*(this.xi-this.px2)||-1e-5>(e.px1-this.xi)*(this.xi-e.px2)?this.RoughSegmentRelationConst.SEPARATE:this.RoughSegmentRelationConst.INTERSECTS)}},{key:"getLength",value:function(){return this._getLength(this.px1,this.py1,this.px2,this.py2)}},{key:"_getLength",value:function(e,t,n,a){var s=n-e,i=a-t;return g(s*s+i*i)}}]),n}(),c=function(){function e(e,t){for(var n,a=0;a<t.length;a++)n=t[a],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),x=function(){function e(t,a,s,i,o,l,r,p){n(this,e),this.top=t,this.bottom=a,this.left=s,this.right=i,this.gap=o,this.sinAngle=l,this.tanAngle=p,1e-4>h(l)?this.pos=s+o:.9999<h(l)?this.pos=t+o:(this.deltaX=(a-t)*h(p),this.pos=s-h(this.deltaX),this.hGap=h(o/r),this.sLeft=new y(s,a,s,t),this.sRight=new y(i,a,i,t))}return c(e,[{key:"getNextLine",value:function(){if(1e-4>h(this.sinAngle)){if(this.pos<this.right){var e=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,e}}else if(!(.9999<h(this.sinAngle))){var n=this.pos-this.deltaX/2,a=this.pos+this.deltaX/2,i=this.bottom,o=this.top;if(this.pos<this.right+this.deltaX){for(;n<this.left&&a<this.left||n>this.right&&a>this.right;)if(this.pos+=this.hGap,n=this.pos-this.deltaX/2,a=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;var l=new y(n,i,a,o);l.compare(this.sLeft)==t().INTERSECTS&&(n=l.xi,i=l.yi),l.compare(this.sRight)==t().INTERSECTS&&(a=l.xi,o=l.yi),0<this.tanAngle&&(n=this.right-(n-this.left),a=this.right-(a-this.left));var s=[n,i,a,o];return this.pos+=this.hGap,s}}else if(this.pos<this.bottom){var r=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,r}return null}}]),e}(),v=function(){function e(e,t){for(var n,a=0;a<t.length;a++)n=t[a],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),m=function(){function e(t,n){a(this,e),this.type=t,this.text=n}return v(e,[{key:"isType",value:function(e){return this.type===e}}]),e}(),k=function(){function e(t){a(this,e),this.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.d=t||"",this.parseData(t),this.processPoints()}return v(e,[{key:"loadFromSegments",value:function(e){this.segments=e,this.processPoints()}},{key:"processPoints",value:function(){for(var e,t=null,n=[0,0],a=0;a<this.segments.length;a++){switch(e=this.segments[a],e.key){case"M":case"L":case"T":e.point=[e.data[0],e.data[1]];break;case"m":case"l":case"t":e.point=[e.data[0]+n[0],e.data[1]+n[1]];break;case"H":e.point=[e.data[0],n[1]];break;case"h":e.point=[e.data[0]+n[0],n[1]];break;case"V":e.point=[n[0],e.data[0]];break;case"v":e.point=[n[0],e.data[0]+n[1]];break;case"z":case"Z":t&&(e.point=[t[0],t[1]]);break;case"C":e.point=[e.data[4],e.data[5]];break;case"c":e.point=[e.data[4]+n[0],e.data[5]+n[1]];break;case"S":e.point=[e.data[2],e.data[3]];break;case"s":e.point=[e.data[2]+n[0],e.data[3]+n[1]];break;case"Q":e.point=[e.data[2],e.data[3]];break;case"q":e.point=[e.data[2]+n[0],e.data[3]+n[1]];break;case"A":e.point=[e.data[5],e.data[6]];break;case"a":e.point=[e.data[5]+n[0],e.data[6]+n[1]];}("m"===e.key||"M"===e.key)&&(t=null),e.point&&(n=e.point,!t&&(t=e.point)),("z"===e.key||"Z"===e.key)&&(t=null)}}},{key:"parseData",value:function(e){var t=this.tokenize(e),n=0,a=t[n],s="BOD";for(this.segments=[];!a.isType(this.EOD);){var o,l=[];if("BOD"!=s)a.isType(this.NUMBER)?o=this.PARAMS[s].length:(n++,o=this.PARAMS[a.text].length,s=a.text);else if("M"==a.text||"m"==a.text)n++,o=this.PARAMS[a.text].length,s=a.text;else return this.parseData("M0,0"+e);if(n+o<t.length){for(var r,p=n;p<n+o;p++)if(r=t[p],r.isType(this.NUMBER))l[l.length]=r.text;else return void console.error("Parameter type is not a number: "+s+","+r.text);var i;if(this.PARAMS[s])i={key:s,data:l};else return void console.error("Unsupported segment type: "+s);this.segments.push(i),n+=o,a=t[n],"M"==s&&(s="L"),"m"==s&&(s="l")}else console.error("Path data ended before all parameters were found")}}},{key:"tokenize",value:function(e){for(var t=[];""!=e;)if(e.match(/^([ \t\r\n,]+)/))e=e.substr(RegExp.$1.length);else if(e.match(/^([aAcChHlLmMqQsStTvVzZ])/))t[t.length]=new m(this.COMMAND,RegExp.$1),e=e.substr(RegExp.$1.length);else if(e.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))t[t.length]=new m(this.NUMBER,parseFloat(RegExp.$1)),e=e.substr(RegExp.$1.length);else return console.error("Unrecognized segment command: "+e),null;return t[t.length]=new m(this.EOD,null),t}},{key:"closed",get:function(){if("undefined"==typeof this._closed){this._closed=!1;var e,t=!0,n=!1;try{for(var a,i,s=this.segments[Symbol.iterator]();!(t=(a=s.next()).done);t=!0)i=a.value,"z"===i.key.toLowerCase()&&(this._closed=!0)}catch(t){n=!0,e=t}finally{try{!t&&s.return&&s.return()}finally{if(n)throw e}}}return this._closed}}]),e}(),O=function(){function e(t){a(this,e),this.d=t,this.parsed=new k(t),this._position=[0,0],this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this._first=null}return v(e,[{key:"setPosition",value:function(e,t){this._position=[e,t],this._first||(this._first=[e,t])}},{key:"segments",get:function(){return this.parsed.segments}},{key:"closed",get:function(){return this.parsed.closed}},{key:"linearPoints",get:function(){if(!this._linearPoints){var e,t=[],n=[],a=!0,i=!1;try{for(var o,l=this.parsed.segments[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var r=o.value,s=r.key.toLowerCase();("m"===s||"z"===s)&&(n.length&&(t.push(n),n=[]),"z"===s)||r.point&&n.push(r.point)}}catch(t){i=!0,e=t}finally{try{!a&&l.return&&l.return()}finally{if(i)throw e}}n.length&&(t.push(n),n=[]),this._linearPoints=t}return this._linearPoints}},{key:"first",get:function(){return this._first},set:function(e){this._first=e}},{key:"position",get:function(){return this._position}},{key:"x",get:function(){return this._position[0]}},{key:"y",get:function(){return this._position[1]}}]),e}(),S=function(){function e(t,n,i,o,l,d){a(this,e);var u=f/180;if(this._segIndex=0,this._numSegs=0,t[0]!=n[0]||t[1]!=n[1]){this._rx=h(i[0]),this._ry=h(i[1]),this._sinPhi=p(o*u),this._cosPhi=r(o*u);var _,y=this._cosPhi*(t[0]-n[0])/2+this._sinPhi*(t[1]-n[1])/2,c=-this._sinPhi*(t[0]-n[0])/2+this._cosPhi*(t[1]-n[1])/2,x=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*c*c-this._ry*this._ry*y*y;if(0>x){var v=g(1-x/(this._rx*this._rx*this._ry*this._ry));this._rx=v,this._ry=v,_=0}else _=(l==d?-1:1)*g(x/(this._rx*this._rx*c*c+this._ry*this._ry*y*y));var s=_*this._rx*c/this._ry,m=-_*this._ry*y/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*s-this._sinPhi*m+(t[0]+n[0])/2,this._C[1]=this._sinPhi*s+this._cosPhi*m+(t[1]+n[1])/2,this._theta=this.calculateVectorAngle(1,0,(y-s)/this._rx,(c-m)/this._ry);var k=this.calculateVectorAngle((y-s)/this._rx,(c-m)/this._ry,(-y-s)/this._rx,(-c-m)/this._ry);!d&&0<k?k-=2*f:d&&0>k&&(k+=2*f),this._numSegs=Math.ceil(h(k/(f/2))),this._delta=k/this._numSegs,this._T=8/3*p(this._delta/4)*p(this._delta/4)/p(this._delta/2),this._from=t}}return v(e,[{key:"getNextSegment",value:function(){var e,t,n;if(this._segIndex==this._numSegs)return null;var a=r(this._theta),s=p(this._theta),i=this._theta+this._delta,o=r(i),l=p(i);return n=[this._cosPhi*this._rx*o-this._sinPhi*this._ry*l+this._C[0],this._sinPhi*this._rx*o+this._cosPhi*this._ry*l+this._C[1]],e=[this._from[0]+this._T*(-this._cosPhi*this._rx*s-this._sinPhi*this._ry*a),this._from[1]+this._T*(-this._sinPhi*this._rx*s+this._cosPhi*this._ry*a)],t=[n[0]+this._T*(this._cosPhi*this._rx*l+this._sinPhi*this._ry*o),n[1]+this._T*(this._sinPhi*this._rx*l-this._cosPhi*this._ry*o)],this._theta=i,this._from=[n[0],n[1]],this._segIndex++,{cp1:e,cp2:t,to:n}}},{key:"calculateVectorAngle",value:function(e,t,n,a){var s=Math.atan2,i=s(t,e),o=s(a,n);return o>=i?o-i:2*f-(i-o)}}]),e}(),R=function(){function e(t,n){a(this,e),this.sets=t,this.closed=n}return v(e,[{key:"fit",value:function(e){var t,n=[],a=!0,s=!1;try{for(var o,l=this.sets[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var r=o.value,p=r.length,f=Math.floor(e*p);if(5>f){if(5>=p)continue;f=5}n.push(this.reduce(r,f))}}catch(e){s=!0,t=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw t}}var g,u="",d=!0,h=!1;try{for(var _,y,c=n[Symbol.iterator]();!(d=(_=c.next()).done);d=!0){y=_.value;for(var x,v=0;v<y.length;v++)x=y[v],u+=0===v?"M"+x[0]+","+x[1]:"L"+x[0]+","+x[1];this.closed&&(u+="z ")}}catch(e){h=!0,g=e}finally{try{!d&&c.return&&c.return()}finally{if(h)throw g}}return u}},{key:"distance",value:function(e,t){return g(l(e[0]-t[0],2)+l(e[1]-t[1],2))}},{key:"reduce",value:function(e,t){if(e.length<=t)return e;for(var n=e.slice(0);n.length>t;){for(var o=-1,l=-1,r=1;r<n.length-1;r++){var i=this.distance(n[r-1],n[r]),a=this.distance(n[r],n[r+1]),p=this.distance(n[r-1],n[r+1]),f=(i+a+p)/2,s=g(f*(f-i)*(f-a)*(f-p));(0>o||s<o)&&(o=s,l=r)}if(0<l)n.splice(l,1);else break}return n}}]),e}(),b=function(){function e(e,t){for(var n,a=0;a<t.length;a++)n=t[a],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),P=function(){function e(){s(this,e)}var n=Math.tan;return b(e,[{key:"line",value:function(e,t,n,a,s){var i=this._doubleLine(e,t,n,a,s);return{type:"path",ops:i}}},{key:"linearPath",value:function(e,t,n){var a=(e||[]).length;if(2<a){for(var s=[],o=0;o<a-1;o++)s=s.concat(this._doubleLine(e[o][0],e[o][1],e[o+1][0],e[o+1][1],n));return t&&(s=s.concat(this._doubleLine(e[a-1][0],e[a-1][1],e[0][0],e[0][1],n))),{type:"path",ops:s}}return 2===a?this.line(e[0][0],e[0][1],e[1][0],e[1][1],n):void 0}},{key:"polygon",value:function(e,t){return this.linearPath(e,!0,t)}},{key:"rectangle",value:function(e,t,n,a,s){return this.polygon([[e,t],[e+n,t],[e+n,t+a],[e,t+a]],s)}},{key:"curve",value:function(e,t){var n=this._curveWithOffset(e,1*(1+.2*t.roughness),t),a=this._curveWithOffset(e,1.5*(1+.22*t.roughness),t);return{type:"path",ops:n.concat(a)}}},{key:"ellipse",value:function(e,t,n,a,s){var i=2*f/s.curveStepCount,o=h(n/2),l=h(a/2);o+=this._getOffset(.05*-o,.05*o,s),l+=this._getOffset(.05*-l,.05*l,s);var r=this._ellipse(i,e,t,o,l,1,i*this._getOffset(.1,this._getOffset(.4,1,s),s),s),p=this._ellipse(i,e,t,o,l,1.5,0,s);return{type:"path",ops:r.concat(p)}}},{key:"arc",value:function(e,t,n,a,s,i,l,g,d){var o=e,_=t,y=h(n/2),c=h(a/2);y+=this._getOffset(.01*-y,.01*y,d),c+=this._getOffset(.01*-c,.01*c,d);for(var x=s,v=i;0>x;)x+=2*f,v+=2*f;v-x>2*f&&(x=0,v=2*f);var m=2*f/d.curveStepCount,k=u(m/2,(v-x)/2),O=this._arc(k,o,_,y,c,x,v,1,d),S=this._arc(k,o,_,y,c,x,v,1.5,d),R=O.concat(S);return l&&(g?(R=R.concat(this._doubleLine(o,_,o+y*r(x),_+c*p(x),d)),R=R.concat(this._doubleLine(o,_,o+y*r(v),_+c*p(v),d))):(R.push({op:"lineTo",data:[o,_]}),R.push({op:"lineTo",data:[o+y*r(x),_+c*p(x)]}))),{type:"path",ops:R}}},{key:"hachureFillArc",value:function(e,t,n,a,s,i,l){var o=e,g=t,d=h(n/2),u=h(a/2);d+=this._getOffset(.01*-d,.01*d,l),u+=this._getOffset(.01*-u,.01*u,l);for(var _=s,y=i;0>_;)_+=2*f,y+=2*f;y-_>2*f&&(_=0,y=2*f);for(var c=(y-_)/l.curveStepCount,x=[],v=[],m=_;m<=y;m+=c)x.push(o+d*r(m)),v.push(g+u*p(m));return x.push(o+d*r(y)),v.push(g+u*p(y)),x.push(o),v.push(g),this.hachureFillShape(x,v,l)}},{key:"solidFillShape",value:function(e,t,n){var a=[];if(e&&t&&e.length&&t.length&&e.length===t.length){var s=n.maxRandomnessOffset||0,o=e.length;if(2<o){a.push({op:"move",data:[e[0]+this._getOffset(-s,s,n),t[0]+this._getOffset(-s,s,n)]});for(var l=1;l<o;l++)a.push({op:"lineTo",data:[e[l]+this._getOffset(-s,s,n),t[l]+this._getOffset(-s,s,n)]})}}return{type:"fillPath",ops:a}}},{key:"hachureFillShape",value:function(e,t,a){var s=[];if(e&&t&&e.length&&t.length){for(var o=e[0],l=e[0],g=t[0],h=t[0],_=1;_<e.length;_++)o=u(o,e[_]),l=d(l,e[_]),g=u(g,t[_]),h=d(h,t[_]);var i=a.hachureAngle,y=a.hachureGap;0>y&&(y=4*a.strokeWidth),y=d(y,.1);for(var c,v=i%180*(f/180),m=r(v),k=p(v),O=n(v),S=new x(g-1,h+1,o-1,l+1,y,k,m,O);null!=(c=S.getNextLine());)for(var R=this._getIntersectingLines(c,e,t),b=0;b<R.length;b++)if(b<R.length-1){var P=R[b],T=R[b+1];s=s.concat(this._doubleLine(P[0],P[1],T[0],T[1],a))}}return{type:"path",ops:s}}},{key:"hachureFillEllipse",value:function(e,t,a,s,i){var o=[],l=h(a/2),r=h(s/2);l+=this._getOffset(.05*-l,.05*l,i),r+=this._getOffset(.05*-r,.05*r,i);var p=i.hachureAngle,d=i.hachureGap;0>=d&&(d=4*i.strokeWidth);var u=i.fillWeight;0>u&&(u=i.strokeWidth/2);for(var _=n(p%180*(f/180)),y=r/l,c=g(y*_*y*_+1),x=y*_/c,v=1/c,m=d/(l*r/g(r*v*(r*v)+l*x*(l*x))/l),k=g(l*l-(e-l+m)*(e-l+m)),O=e-l+m;O<e+l;O+=m){k=g(l*l-(e-O)*(e-O));var S=this._affine(O,t-k,e,t,x,v,y),R=this._affine(O,t+k,e,t,x,v,y);o=o.concat(this._doubleLine(S[0],S[1],R[0],R[1],i))}return{type:"path",ops:o}}},{key:"svgPath",value:function(e,t){e=(e||"").replace(/\n/g," ").replace(/(-)/g," -").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var n=new O(e);if(t.simplification){var a=new R(n.linearPoints,n.closed),o=a.fit(t.simplification);n=new O(o)}for(var l=[],r=n.segments||[],p=0;p<r.length;p++){var i=r[p],s=0<p?r[p-1]:null,f=this._processSegment(n,i,s,t);f&&f.length&&(l=l.concat(f))}return{type:"path",ops:l}}},{key:"_bezierTo",value:function(e,t,n,a,s,l,r,p){for(var o=[],g=[p.maxRandomnessOffset||1,(p.maxRandomnessOffset||1)+.5],d=null,f=0;2>f;f++)0===f?o.push({op:"move",data:[r.x,r.y]}):o.push({op:"move",data:[r.x+this._getOffset(-g[0],g[0],p),r.y+this._getOffset(-g[0],g[0],p)]}),d=[s+this._getOffset(-g[f],g[f],p),l+this._getOffset(-g[f],g[f],p)],o.push({op:"bcurveTo",data:[e+this._getOffset(-g[f],g[f],p),t+this._getOffset(-g[f],g[f],p),n+this._getOffset(-g[f],g[f],p),a+this._getOffset(-g[f],g[f],p),d[0],d[1]]});return r.setPosition(d[0],d[1]),o}},{key:"_processSegment",value:function(e,t,n,a){var s=[];switch(t.key){case"M":case"m":{var o="m"===t.key;if(2<=t.data.length){var l=+t.data[0],r=+t.data[1];o&&(l+=e.x,r+=e.y);var p=1*(a.maxRandomnessOffset||0);l+=this._getOffset(-p,p,a),r+=this._getOffset(-p,p,a),e.setPosition(l,r),s.push({op:"move",data:[l,r]})}break}case"L":case"l":{var g="l"===t.key;if(2<=t.data.length){var d=+t.data[0],u=+t.data[1];g&&(d+=e.x,u+=e.y),s=s.concat(this._doubleLine(e.x,e.y,d,u,a)),e.setPosition(d,u)}break}case"H":case"h":{var h="h"===t.key;if(t.data.length){var _=+t.data[0];h&&(_+=e.x),s=s.concat(this._doubleLine(e.x,e.y,_,e.y,a)),e.setPosition(_,e.y)}break}case"V":case"v":{var y="v"===t.key;if(t.data.length){var c=+t.data[0];y&&(c+=e.y),s=s.concat(this._doubleLine(e.x,e.y,e.x,c,a)),e.setPosition(e.x,c)}break}case"Z":case"z":{e.first&&(s=s.concat(this._doubleLine(e.x,e.y,e.first[0],e.first[1],a)),e.setPosition(e.first[0],e.first[1]),e.first=null);break}case"C":case"c":{var x="c"===t.key;if(6<=t.data.length){var v=+t.data[0],m=+t.data[1],k=+t.data[2],O=+t.data[3],R=+t.data[4],b=+t.data[5];x&&(v+=e.x,k+=e.x,R+=e.x,m+=e.y,O+=e.y,b+=e.y);var P=this._bezierTo(v,m,k,O,R,b,e,a);s=s.concat(P),e.bezierReflectionPoint=[R+(R-k),b+(b-O)]}break}case"S":case"s":{var T="s"===t.key;if(4<=t.data.length){var C=+t.data[0],E=+t.data[1],A=+t.data[2],w=+t.data[3];T&&(C+=e.x,A+=e.x,E+=e.y,w+=e.y);var L=C,N=E,I=n?n.key:"",M=null;("c"==I||"C"==I||"s"==I||"S"==I)&&(M=e.bezierReflectionPoint),M&&(L=M[0],N=M[1]);var z=this._bezierTo(L,N,C,E,A,w,e,a);s=s.concat(z),e.bezierReflectionPoint=[A+(A-C),w+(w-E)]}break}case"Q":case"q":{var D="q"===t.key;if(4<=t.data.length){var q=+t.data[0],F=+t.data[1],U=+t.data[2],W=+t.data[3];D&&(q+=e.x,U+=e.x,F+=e.y,W+=e.y);var B=1*(1+.2*a.roughness),X=1.5*(1+.22*a.roughness);s.push({op:"move",data:[e.x+this._getOffset(-B,B,a),e.y+this._getOffset(-B,B,a)]});var V=[U+this._getOffset(-B,B,a),W+this._getOffset(-B,B,a)];s.push({op:"qcurveTo",data:[q+this._getOffset(-B,B,a),F+this._getOffset(-B,B,a),V[0],V[1]]}),s.push({op:"move",data:[e.x+this._getOffset(-X,X,a),e.y+this._getOffset(-X,X,a)]}),V=[U+this._getOffset(-X,X,a),W+this._getOffset(-X,X,a)],s.push({op:"qcurveTo",data:[q+this._getOffset(-X,X,a),F+this._getOffset(-X,X,a),V[0],V[1]]}),e.setPosition(V[0],V[1]),e.quadReflectionPoint=[U+(U-q),W+(W-F)]}break}case"T":case"t":{var f="t"===t.key;if(2<=t.data.length){var G=+t.data[0],H=+t.data[1];f&&(G+=e.x,H+=e.y);var $=G,Q=H,Z=n?n.key:"",M=null;("q"==Z||"Q"==Z||"t"==Z||"T"==Z)&&(M=e.quadReflectionPoint),M&&($=M[0],Q=M[1]);var j=1*(1+.2*a.roughness),K=1.5*(1+.22*a.roughness);s.push({op:"move",data:[e.x+this._getOffset(-j,j,a),e.y+this._getOffset(-j,j,a)]});var Y=[G+this._getOffset(-j,j,a),H+this._getOffset(-j,j,a)];s.push({op:"qcurveTo",data:[$+this._getOffset(-j,j,a),Q+this._getOffset(-j,j,a),Y[0],Y[1]]}),s.push({op:"move",data:[e.x+this._getOffset(-K,K,a),e.y+this._getOffset(-K,K,a)]}),Y=[G+this._getOffset(-K,K,a),H+this._getOffset(-K,K,a)],s.push({op:"qcurveTo",data:[$+this._getOffset(-K,K,a),Q+this._getOffset(-K,K,a),Y[0],Y[1]]}),e.setPosition(Y[0],Y[1]),e.quadReflectionPoint=[G+(G-$),H+(H-Q)]}break}case"A":case"a":{var J="a"===t.key;if(7<=t.data.length){var ee=+t.data[0],te=+t.data[1],ne=+t.data[2],ae=+t.data[3],se=+t.data[4],ie=+t.data[5],oe=+t.data[6];if(J&&(ie+=e.x,oe+=e.y),ie==e.x&&oe==e.y)break;if(0==ee||0==te)s=s.concat(this._doubleLine(e.x,e.y,ie,oe,a)),e.setPosition(ie,oe);else for(var le=a.maxRandomnessOffset||0,re=0;1>re;re++)for(var i,pe=new S([e.x,e.y],[ie,oe],[ee,te],ne,!!ae,!!se),fe=pe.getNextSegment();fe;)i=this._bezierTo(fe.cp1[0],fe.cp1[1],fe.cp2[0],fe.cp2[1],fe.to[0],fe.to[1],e,a),s=s.concat(i),fe=pe.getNextSegment()}break}default:}return s}},{key:"_getOffset",value:function(e,t,n){return n.roughness*(Math.random()*(t-e)+e)}},{key:"_affine",value:function(e,t,n,a,s,i,o){return[-n*i-a*s+n+i*e+s*t,o*(n*s-a*i)+a+-o*s*e+o*i*t]}},{key:"_doubleLine",value:function(e,t,n,a,s){var i=this._line(e,t,n,a,s,!0,!1),o=this._line(e,t,n,a,s,!0,!0);return i.concat(o)}},{key:"_line",value:function(e,t,n,a,s,i,o){var r=l(e-n,2)+l(t-a,2),p=s.maxRandomnessOffset||0;100*(p*p)>r&&(p=g(r)/10);var f=p/2,d=.2+.2*Math.random(),u=s.bowing*s.maxRandomnessOffset*(a-t)/200,h=s.bowing*s.maxRandomnessOffset*n/200;u=this._getOffset(-u,u,s),h=this._getOffset(-h,h,s);var _=[];return i&&(o?_.push({op:"move",data:[e+this._getOffset(-f,f,s),t+this._getOffset(-f,f,s)]}):_.push({op:"move",data:[e+this._getOffset(-p,p,s),t+this._getOffset(-p,p,s)]})),o?_.push({op:"bcurveTo",data:[u+e+(n-e)*d+this._getOffset(-f,f,s),h+t+(a-t)*d+this._getOffset(-f,f,s),u+e+2*(n-e)*d+this._getOffset(-f,f,s),h+t+2*(a-t)*d+this._getOffset(-f,f,s),n+this._getOffset(-f,f,s),a+this._getOffset(-f,f,s)]}):_.push({op:"bcurveTo",data:[u+e+(n-e)*d+this._getOffset(-p,p,s),h+t+(a-t)*d+this._getOffset(-p,p,s),u+e+2*(n-e)*d+this._getOffset(-p,p,s),h+t+2*(a-t)*d+this._getOffset(-p,p,s),n+this._getOffset(-p,p,s),a+this._getOffset(-p,p,s)]}),_}},{key:"_curve",value:function(e,t,n){var a=e.length,o=[];if(3<a){var l=[],r=1-n.curveTightness;o.push({op:"move",data:[e[1][0],e[1][1]]});for(var s,p=1;p+2<a;p++)s=e[p],l[0]=[s[0],s[1]],l[1]=[s[0]+(r*e[p+1][0]-r*e[p-1][0])/6,s[1]+(r*e[p+1][1]-r*e[p-1][1])/6],l[2]=[e[p+1][0]+(r*e[p][0]-r*e[p+2][0])/6,e[p+1][1]+(r*e[p][1]-r*e[p+2][1])/6],l[3]=[e[p+1][0],e[p+1][1]],o.push({op:"bcurveTo",data:[l[1][0],l[1][1],l[2][0],l[2][1],l[3][0],l[3][1]]});if(t&&2===t.length){var i=n.maxRandomnessOffset;o.push({ops:"lineTo",data:[t[0]+this._getOffset(-i,i,n),t[1]+ +this._getOffset(-i,i,n)]})}}else 3===a?(o.push({op:"move",data:[e[1][0],e[1][1]]}),o.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):2===a&&(o=o.concat(this._doubleLine(e[0][0],e[0][1],e[1][0],e[1][1],n)));return o}},{key:"_ellipse",value:function(e,t,n,a,s,i,l,g){var o=this._getOffset(-.5,.5,g)-f/2,d=[];d.push([this._getOffset(-i,i,g)+t+.9*a*r(o-e),this._getOffset(-i,i,g)+n+.9*s*p(o-e)]);for(var u=o;u<2*f+o-.01;u+=e)d.push([this._getOffset(-i,i,g)+t+a*r(u),this._getOffset(-i,i,g)+n+s*p(u)]);return d.push([this._getOffset(-i,i,g)+t+a*r(o+2*f+.5*l),this._getOffset(-i,i,g)+n+s*p(o+2*f+.5*l)]),d.push([this._getOffset(-i,i,g)+t+.98*a*r(o+l),this._getOffset(-i,i,g)+n+.98*s*p(o+l)]),d.push([this._getOffset(-i,i,g)+t+.9*a*r(o+.5*l),this._getOffset(-i,i,g)+n+.9*s*p(o+.5*l)]),this._curve(d,null,g)}},{key:"_curveWithOffset",value:function(e,t,n){for(var a=[[e[0][0]+this._getOffset(-t,t,n),e[0][1]+this._getOffset(-t,t,n)],[e[0][0]+this._getOffset(-t,t,n),e[0][1]+this._getOffset(-t,t,n)]],s=1;s<e.length;s++)a.push([e[s][0]+this._getOffset(-t,t,n),e[s][1]+this._getOffset(-t,t,n)]),s===e.length-1&&a.push([e[s][0]+this._getOffset(-t,t,n),e[s][1]+this._getOffset(-t,t,n)]);return this._curve(a,null,n)}},{key:"_arc",value:function(e,t,n,a,s,i,l,f,g){var o=i+this._getOffset(-.1,.1,g),d=[];d.push([this._getOffset(-f,f,g)+t+.9*a*r(o-e),this._getOffset(-f,f,g)+n+.9*s*p(o-e)]);for(var u=o;u<=l;u+=e)d.push([this._getOffset(-f,f,g)+t+a*r(u),this._getOffset(-f,f,g)+n+s*p(u)]);return d.push([t+a*r(l),n+s*p(l)]),d.push([t+a*r(l),n+s*p(l)]),this._curve(d,null,g)}},{key:"_getIntersectingLines",value:function(e,n,a){for(var s,o=[],l=new y(e[0],e[1],e[2],e[3]),r=0;r<n.length;r++)s=new y(n[r],a[r],n[(r+1)%n.length],a[(r+1)%n.length]),l.compare(s)==t().INTERSECTS&&o.push([l.xi,l.yi]);return o}}]),e}(),T=function(){function e(e,t){for(var n,a=0;a<t.length;a++)n=t[a],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();self._roughScript=self.document&&self.document.currentScript&&self.document.currentScript.src;var C=function(){function e(t,n){o(this,e),this.config=n||{},this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fill:null,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1},this.config.options&&(this.defaultOptions=this._options(this.config.options))}return T(e,[{key:"lib",value:function(){var e=i(regeneratorRuntime.mark(function e(){var t,n,a,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._renderer||(window.workly&&!this.config.noWorker?(t=Function.prototype.toString,n=this.config.worklyURL||"https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js",a=this.config.roughURL||self._roughScript,a&&n?(s="importScripts('"+n+"', '"+a+"');\nworkly.expose(self.rough.createRenderer());",i=URL.createObjectURL(new Blob([s])),this._renderer=workly.proxy(i)):this._renderer=new P):this._renderer=new P),e.abrupt("return",this._renderer);case 2:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"line",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n,a,s,i){var l,o,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=this._options(i),e.next=3,this.lib();case 3:return o=e.sent,e.next=6,o.line(t,n,a,s,l);case 6:r=e.sent,this._draw(this.ctx,r,l);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"rectangle",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n,a,s,i){var l,o,r,p,f,g,d,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=this._options(i),e.next=3,this.lib();case 3:if(o=e.sent,!l.fill){e.next=19;break}if(r=this.ctx,p=[t,t+a,t+a,t],f=[n,n,n+s,n+s],"solid"!==l.fillStyle){e.next=15;break}return e.next=11,o.solidFillShape(p,f,l);case 11:g=e.sent,this._fill(r,g,l),e.next=19;break;case 15:return e.next=17,o.hachureFillShape(p,f,l);case 17:d=e.sent,this._fillSketch(r,d,l);case 19:return e.next=21,o.rectangle(t,n,a,s,l);case 21:u=e.sent,this._draw(this.ctx,u,l);case 23:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"ellipse",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n,a,s,i){var l,o,r,p,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=this._options(i),e.next=3,this.lib();case 3:if(o=e.sent,!l.fill){e.next=16;break}if("solid"!==l.fillStyle){e.next=12;break}return e.next=8,o.ellipse(t,n,a,s,l);case 8:r=e.sent,this._fill(this.ctx,r,l),e.next=16;break;case 12:return e.next=14,o.hachureFillEllipse(t,n,a,s,l);case 14:p=e.sent,this._fillSketch(this.ctx,p,l);case 16:return e.next=18,o.ellipse(t,n,a,s,l);case 18:f=e.sent,this._draw(this.ctx,f,l);case 20:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"circle",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n,a,s){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ellipse(t,n,a,a,s);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"linearPath",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n){var a,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._options(n),e.next=3,this.lib();case 3:return s=e.sent,e.next=6,s.linearPath(t,!1,a);case 6:i=e.sent,this._draw(this.ctx,i,a);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"polygon",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n){var a,s,i,o,l,r,f,g,d,u,p,h,_;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._options(n),e.next=3,this.lib();case 3:if(s=e.sent,!a.fill){e.next=36;break}for(i=[],o=[],l=!0,r=!1,f=void 0,e.prev=9,g=t[Symbol.iterator]();!(l=(d=g.next()).done);l=!0)u=d.value,i.push(u[0]),o.push(u[1]);e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](9),r=!0,f=e.t0;case 17:e.prev=17,e.prev=18,!l&&g.return&&g.return();case 20:if(e.prev=20,!r){e.next=23;break}throw f;case 23:return e.finish(20);case 24:return e.finish(17);case 25:if("solid"!==a.fillStyle){e.next=32;break}return e.next=28,s.solidFillShape(i,o,a);case 28:p=e.sent,this._fill(this.ctx,p,a),e.next=36;break;case 32:return e.next=34,s.hachureFillShape(i,o,a);case 34:h=e.sent,this._fillSketch(this.ctx,h,a);case 36:return e.next=38,s.linearPath(t,!0,a);case 38:_=e.sent,this._draw(this.ctx,_,a);case 40:case"end":return e.stop();}},e,this,[[9,13,17,25],[18,,20,24]])}));return function(){return e.apply(this,arguments)}}()},{key:"arc",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n,a,s,i,l,r,p){var f,o,g,d,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f=this._options(p),e.next=3,this.lib();case 3:if(o=e.sent,!(r&&f.fill)){e.next=16;break}if("solid"!==f.fillStyle){e.next=12;break}return e.next=8,o.arc(t,n,a,s,i,l,!0,!1,f);case 8:g=e.sent,this._fill(this.ctx,g,f),e.next=16;break;case 12:return e.next=14,o.hachureFillArc(t,n,a,s,i,l,f);case 14:d=e.sent,this._fillSketch(this.ctx,d,f);case 16:return e.next=18,o.arc(t,n,a,s,i,l,r,!0,f);case 18:u=e.sent,this._draw(this.ctx,u,f);case 20:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"curve",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n){var a,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._options(n),e.next=3,this.lib();case 3:return s=e.sent,e.next=6,s.curve(t,a);case 6:i=e.sent,this._draw(this.ctx,i,a);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"path",value:function(){var e=i(regeneratorRuntime.mark(function e(t,n){var a,s,i,o,l,r,p,f,g,d,h,_,y,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return a=this._options(n),e.next=5,this.lib();case 5:if(s=e.sent,!a.fill){e.next=34;break}if("solid"!==a.fillStyle){e.next=15;break}this.ctx.save(),this.ctx.fillStyle=a.fill,i=new Path2D(t),this.ctx.fill(i),this.ctx.restore(),e.next=34;break;case 15:o=[0,0];try{l="http://www.w3.org/2000/svg",r=document.createElementNS(l,"svg"),r.setAttribute("width","0"),r.setAttribute("height","0"),p=document.createElementNS(l,"path"),p.setAttribute("d",t),r.appendChild(p),document.body.appendChild(r),f=p.getBBox(),f&&(o[0]=f.width||0,o[1]=f.height||0),document.body.removeChild(r)}catch(e){}return o[0]*o[1]||(o=[this.canvas.width||100,this.canvas.height||100]),o[0]=u(4*o[0],this.canvas.width),o[1]=u(4*o[1],this.canvas.height),g=[0,o[0],o[0],0],d=[0,0,o[1],o[1]],e.next=24,s.hachureFillShape(g,d,a);case 24:h=e.sent,_=document.createElement("canvas"),_.width=o[0],_.height=o[1],this._fillSketch(_.getContext("2d"),h,a),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(_,"repeat"),y=new Path2D(t),this.ctx.fill(y),this.ctx.restore();case 34:return e.next=36,s.svgPath(t,a);case 36:c=e.sent,this._draw(this.ctx,c,a);case 38:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_options",value:function(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}},{key:"_draw",value:function(e,t,n){e.save(),e.strokeStyle=n.stroke,e.lineWidth=n.strokeWidth,this._drawToContext(e,t),e.restore()}},{key:"_fillSketch",value:function(e,t,n){var a=n.fillWeight;0>a&&(a=n.strokeWidth/2),e.save(),e.strokeStyle=n.fill,e.lineWidth=a,this._drawToContext(e,t),e.restore()}},{key:"_fill",value:function(e,t,n){e.save(),e.fillStyle=n.fill,t.type="fillPath",this._drawToContext(e,t,n),e.restore()}},{key:"_drawToContext",value:function(e,t){if("path"===t.type||"fillPath"===t.type){e.beginPath();var n,a=!0,s=!1;try{for(var i,o=t.ops[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var l=i.value,r=l.data;switch(l.op){case"move":e.moveTo(r[0],r[1]);break;case"bcurveTo":e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"qcurveTo":e.quadraticCurveTo(r[0],r[1],r[2],r[3]);break;case"lineTo":e.lineTo(r[0],r[1]);}}}catch(e){s=!0,n=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}"fillPath"===t.type?e.fill():e.stroke()}}}],[{key:"createRenderer",value:function(){return new P}}]),e}();return{canvas:function(e,t){return new C(e,t)},createRenderer:function(){return C.createRenderer()}}}();